#:kivy 2.3.1
<MoodSelect>:
    canvas.before:
        Color:
            rgba: 1, 1, 1, 1  # สีขาวเป็นพื้นฐาน
        Rectangle:
            source: "Images/background.png"
            size: self.size
            pos: self.pos

    text_input: text_input_field
    orientation: "vertical"
    spacing: 20
    padding: 100
           

    AnchorLayout:  # ใช้ AnchorLayout เพื่อให้ GridLayout อยู่ตรงกลาง
        anchor_x: "center"
        anchor_y: "center"

        GridLayout:
            cols: 1
            spacing: 20
            size_hint: None, None
            width: self.minimum_width  # ปรับขนาดให้พอดีเนื้อหา
            height: self.minimum_height
            pos_hint: {"center_x": 0.5, "center_y": 0.5}

            FitImage:
                id: disk_image
                source: "Images/disk.gif"
                opacity: 0
                size_hint: None, None
                size: 350, 350
                keep_ratio: True
                allow_stretch: True
                anim_delay: 0.05  # กำหนดความเร็ว animation
                anim_loop: 1      # วนลูปการเล่น animation

            Label:
                id: track_name_label
                text: "Let’s start your day with some great music!"
                size_hint_y: None
                height: 60
                font_size: 30
                halign: "center"
                valign: "middle"
                color: 0.996, 0.412, 0.408, 1

            MDLinearProgressIndicator:
                id: progress_bar
                min: 0
                max: 30
                value: 0
                size_hint_y: None
                height: "10dp"
                
            MDLabel:
                id: time_label
                text: "0:00 / 0:30"
                halign: "center"
                size_hint_y: None
                height: "20dp"   
                
    Widget:
        size_hint_y: None
        height: 20  

    
    MDLabel:
        text: "Select Emoji and Enter your Mood To Get the Song"
        halign: "center"
        bold: True
        size_hint_y: None
        height: 60
        font_style: "Display"
        role: "small"
        spacing: 10
        padding: [20, 0, 20, 20]
        color: 0.329, 0.8, 0.972, 1

    Widget:
        size_hint_y: None
        height: 20  

    BoxLayout:
        id: emoji_grid
        size_hint_y: None 
        
        BoxLayout:
            orientation: 'vertical'
            spacing: 5  # ระยะห่างระหว่างปุ่มกับข้อความ
            MoodButton:
                background_normal: 'Images/happy.png'
                on_press: root.emoji_select('happy', self)
            Label:
                font_size: 14  
                color: 1, 1, 1, 1  # สีขาว
                size_hint_y: None
                height: 20

        BoxLayout:
            orientation: 'vertical'
            spacing: 5  # ระยะห่างระหว่างปุ่มกับข้อความ
            MoodButton:
                background_normal: 'Images/sad.png'
                on_press: root.emoji_select('sad', self)
            Label:
                font_size: 14  
                color: 1, 1, 1, 1  # สีขาว
                size_hint_y: None
                height: 20


        BoxLayout:
            orientation: 'vertical'
            spacing: 5  # ระยะห่างระหว่างปุ่มกับข้อความ
            MoodButton:
                background_normal: 'Images/angry.png'
                on_press: root.emoji_select('angry', self)
            Label:
                font_size: 14  
                color: 1, 1, 1, 1  # สีขาว
                size_hint_y: None
                height: 20


        BoxLayout:
            orientation: 'vertical'
            spacing: 5  # ระยะห่างระหว่างปุ่มกับข้อความ
            MoodButton:
                background_normal: 'Images/calm.png'
                on_press: root.emoji_select('calm', self)
            Label:
                font_size: 14  
                color: 1, 1, 1, 1  # สีขาว
                size_hint_y: None
                height: 20


        BoxLayout:
            orientation: 'vertical'
            spacing: 5  # ระยะห่างระหว่างปุ่มกับข้อความ
            MoodButton:
                background_normal: 'Images/excited.png'
                on_press: root.emoji_select('excited', self)
            Label:
                font_size: 14  
                color: 1, 1, 1, 1  # สีขาว
                size_hint_y: None
                height: 20


        BoxLayout:
            orientation: 'vertical'
            spacing: 5  # ระยะห่างระหว่างปุ่มกับข้อความ
            MoodButton:
                background_normal: 'Images/horny.png'
                on_press: root.emoji_select('horny', self)        
            Label:
                font_size: 14  
                color: 1, 1, 1, 1  # สีขาว
                size_hint_y: None
                height: 20

    MDLabel:
        text: "What’s your mood like today?"
        halign: "center"
        bold: True
        size_hint_y: None
        height: 40
        font_style: "Display"
        role: "small"
        spacing: 10
        color: 0.996, 0.412, 0.408, 1            

    AnchorLayout:
        anchor_x: 'center'
        size_hint_y: None
        height: "120dp"
        padding: [20, 0, 20, 0]

        BoxLayout:
            orientation: 'horizontal'
            size_hint: 0.5, None  # ครึ่งความกว้างของหน้าจอ
            height: "60dp"  # ความสูงเพิ่มขึ้น
            spacing: "10dp"
            pos_hint: {'center_x': 0.5}

           

            MDTextField:
                id: text_input_field
                mode: "filled"
                radius: [25, 25, 25, 25]
                multiline: False
                hint_text: "Describe your feeling..."
                line_color_normal: 0.996, 0.412, 0.408, 1
                line_color_focus: 0.329, 0.8, 0.972, 1
                text_color: 0, 0, 0, 1
                hint_text_color: 0.6, 0.6, 0.6, 1
                font_size: "16sp"
                padding: [25, 20, 15, 20]
                size_hint_x: 0.85
                
            MDIconButton:
                icon: "send"
                theme_icon_color: "Custom"
                icon_color: 0.996, 0.412, 0.408, 1
                md_bg_color: 0.329, 0.8, 0.972, 0.8
                size_hint: None, None
                size: "60dp", "60dp"
                radius: [20, 20, 20, 20]
                on_press: root.submit_mood()
            
   
    MDButton:
        style: "elevated"
        pos_hint: {"center_x": .5, "center_y": .5}
        size_hint: None, None
        size: "200dp", "40dp"
        on_press: root.change_background()
        text_color: 0.996, 0.412, 0.408, 1
        font_size: "18sp"

        MDButtonText:
            text: "Change Background"

    MDButton:
        style: "elevated"
        pos_hint: {"center_x": .5, "center_y": .5}
        size_hint: None, None
        size: "200dp", "40dp"  # ปรับขนาดปุ่ม
        on_press: root.reset_app()  # เพิ่มการทำงานเมื่อกดปุ่ม
        text_color: 0.996, 0.412, 0.408, 1
        font_size: "18sp"  # ขนาดฟอนต์
        MDButtonText:
            text: "Clear"
            

# Custom button for mood emojis
<MoodButton@Button>:

    background_normal: ''
    background_color: 1, 1, 1, 1
    border: (0, 0, 0, 0)
    size_hint: (None, None)
    size: 80, 80
    shadow_color: "red"

    # เพิ่มเอฟเฟกต์เมื่อกดปุ่ม
    
    background_down: self.background_normal
    background_color_down: 0.8, 0.8, 0.8, 1 

    # เพิ่มเอฟเฟกต์การเปลี่ยนสีเมื่อเมาส์ชี้
    canvas.before:
        Color:
            rgba: 0.9, 0.9, 0.9, 1 if self.state == 'normal' else 0.7, 0.7, 0.7, 1
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [10, 10, 10, 10]  # ทำมุมโค้ง
            
    # เพิ่มเงา
    canvas.before:
        Color:
            rgba: 0.5, 0.5, 0.5, 0.2
        RoundedRectangle:
            pos: self.x + 2, self.y - 2
            size: self.size
            radius: [10, 10, 10, 10]



